<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
  
  

  


  <head>
    <title>
      #22995 (Deprecate auto_now and auto_now_add and document alternatives)
     – Django
    </title>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
      <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!--[if IE]><script type="text/javascript">
      if (/^#__msie303:/.test(window.location.hash))
        window.location.replace(window.location.hash.replace(/^#__msie303:/, '#'));
    </script><![endif]-->
        <link rel="search" href="/search" />
        <link rel="prev" href="/ticket/22994" title="Ticket #22994" />
        <link rel="last" href="/ticket/26358" title="Ticket #26358" />
        <link rel="help" href="/wiki/TracGuide" />
        <link rel="alternate" href="/ticket/22995?format=csv" type="text/csv" class="csv" title="Comma-delimited Text" /><link rel="alternate" href="/ticket/22995?format=tab" type="text/tab-separated-values" class="tab" title="Tab-delimited Text" /><link rel="alternate" href="/ticket/22995?format=rss" type="application/rss+xml" class="rss" title="RSS Feed" />
        <link rel="next" href="/ticket/22996" title="Ticket #22996" />
        <link rel="start" href="/wiki" />
        <link rel="stylesheet" href="/chrome/common/css/trac.css" type="text/css" /><link rel="stylesheet" href="/chrome/common/css/ticket.css" type="text/css" />
        <link rel="first" href="/ticket/1" title="Ticket #1" />
        <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
        <link rel="icon" href="/favicon.ico" type="image/x-icon" />
    <style id="trac-noscript" type="text/css">.trac-noscript { display: none !important }</style>
      <link type="application/opensearchdescription+xml" rel="search" href="/search/opensearch" title="Search Django" />
    <script type="text/javascript">
      var auto_preview_timeout=2.0;
      var form_token="f425f7760134ec65c1d73e2e";
      var comments_prefs={"comments_only":"false","comments_order":"oldest"};
    </script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/jquery.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/babel.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/trac.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/search.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/folding.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/wikitoolbar.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/resizer.js"></script>
      <script type="text/javascript" charset="utf-8" src="/chrome/common/js/auto_preview.js"></script>
    <script type="text/javascript">
      jQuery("#trac-noscript").remove();
      jQuery(document).ready(function($) {
        $(".trac-autofocus").focus();
        $(".trac-target-new").attr("target", "_blank");
        setTimeout(function() { $(".trac-scroll").scrollToTop() }, 1);
        $(".trac-disable-on-submit").disableOnSubmit();
      });
    </script>
    <script type="text/javascript" src="/chrome/common/js/threaded_comments.js"></script>
    <script type="text/javascript">
      jQuery(document).ready(function($) {
        $("div.description").find("h1,h2,h3,h4,h5,h6").addAnchor(_("Link to this section"));
        $(".foldable").enableFolding(false, true);
      /*<![CDATA[*/
        $("#attachments").toggleClass("collapsed");
        $("#trac-up-attachments").click(function () {
          $("#attachments").removeClass("collapsed");
          return true;
        });
        $("#modify").parent().toggleClass("collapsed");
        $(".trac-topnav a").click(function() { $("#modify").parent().removeClass("collapsed"); });
        /* only enable control elements for the currently selected action */
        var actions = $("#action input[name='action']");
        function updateActionFields() {
          actions.each(function () {
            $(this).siblings().find("*[id]").enable($(this).checked());
            $(this).siblings().filter("*[id]").enable($(this).checked());
          });
        }
        actions.click(updateActionFields);
        updateActionFields();
        function setRevertHandler() {
          $("button.trac-revert").click(function() {
            var div = $("div", this);
            var field_name = div[0].id.substr(7);
            var field_value = div.text();
            var input = $("#propertyform *[name=field_" + field_name + "]");
            if (input.length > 0) {
              if (input.filter("input[type=radio]").length > 0) {
                input.val([field_value]);
              } else if (input.filter("input[type=checkbox]").length > 0) {
                input.val(field_value == "1" ? [field_value] : []);
              } else {
                input.val(field_value);
              }
            } else { // Special case for CC checkbox
              input = $("#propertyform input[name=cc_update]").val([]);
            }
            input.change();
            $(this).closest("li").remove();
            return false;
          });
        }
        setRevertHandler();
        var comment_focused = false;
        $("#comment").focus(function() { comment_focused = true; })
                     .blur(function() { comment_focused = false; });
        $("#propertyform").autoSubmit({preview: '1'}, function(data, reply) {
          var items = $(reply);
          // Update ticket box
          $("#ticket").replaceWith(items.filter('#ticket'));
          // Unthread, unrevert and update changelog
          if (!$('#trac-comments-oldest').checked())
            $('#trac-comments-oldest').click().change();
          $("#changelog").replaceWith(items.filter("#changelog"));
          if ($('#trac-comments-only-toggle').attr('checked'))
            $('#trac-comments-only-toggle').click().attr('checked', true);
          // Show warning
          var new_changes = $("#changelog .trac-new");
          $("#trac-edit-warning").toggle(new_changes.length != 0);
          if (new_changes.length != 0)
            $("#changelog").parent().show().removeClass("collapsed");
          // Update view time
          $("#propertyform input[name='view_time']").replaceWith(items.filter("input[name='view_time']"));
          // Update preview
          var preview = $("#ticketchange").html(items.filter('#preview').children());
          var show_preview = preview.children().length != 0;
          $("#ticketchange").toggle(show_preview);
          setRevertHandler();
          // Collapse property form if comment editor has focus
          if (show_preview && comment_focused)
            $("#modify").parent().addClass("collapsed");
          // Execute scripts to load stylesheets
          items.filter("script").appendTo("head");
        }, "#ticketchange .trac-loading");
        $("#trac-comment-editor").autoSubmit({preview_comment: '1'}, function(data, reply) {
          var comment = $("#trac-comment-editor").next("div.comment").html(reply);
          comment.toggle(comment.children().length != 0);
        }, "#changelog .trac-loading");
        /*]]>*/
      });
    </script>
    <!--[if lte IE 8]>
        <link rel="stylesheet" href="${href.chrome('site/css/output-ie.css')}" />
     <![endif]-->
    <!--[if gt IE 8]><!-->
        <link rel="stylesheet" href="/chrome/site/css/output.css" />
    <!--<![endif]-->
    <link rel="stylesheet" href="/chrome/site/css/trachacks.css" />
    <script src="//ajax.googleapis.com/ajax/libs/webfont/1.5.6/webfont.js"></script>
    <script>
    WebFont.load({
        google: {
            families: ['Inconsolata:400,700:latin', 'Roboto:400italic,700italic,300,700,400:latin']
        }
    });
    </script>
    <script src="/chrome/site/js/lib/modernizr.js"></script>
      <script type="text/javascript" src="/chrome/site/tickethacks.js"></script>
  </head>
  <body id="generic">
    <div role="banner" id="top">
      <div class="container">
        <a class="logo" href="https://www.djangoproject.com/">Django</a>
        <p class="meta">The web framework for perfectionists with deadlines.</p>
        <nav role="navigation">
          <ul>
            <li><a href="https://www.djangoproject.com/">Overview</a></li>
            <li><a href="https://www.djangoproject.com/download/">Download</a></li>
            <li><a href="https://docs.djangoproject.com/">Documentation</a></li>
            <li><a href="https://www.djangoproject.com/weblog/">News</a></li>
            <li><a href="https://www.djangoproject.com/community/">Community</a></li>
            <li class="active"><a href="/">Code</a></li>
            <li><a href="https://www.djangoproject.com/foundation/">About</a></li>
            <li><a href="https://www.djangoproject.com/fundraising/">♥ Donate</a></li>
          </ul>
        </nav>
      </div>
    </div>
    <div class="copy-banner">
      <div class="container">
        <h1>Code</h1>
      </div>
    </div>
      <div class="container full-width">
        <div role="main">
          <div id="metanav" class="nav">
    <ul>
      <li class="first"><a href="/github/login">GitHub Login</a></li><li><a href="/login">DjangoProject Login</a></li><li><a href="/prefs">Preferences</a></li><li class="last"><a href="/rpc">API</a></li>
    </ul>
  </div>
          <div id="mainnav" class="nav">
    <ul>
      <li class="first active"><a href="/query">View Tickets</a></li><li><a href="/wiki/Reports">Reports</a></li><li><a href="/timeline">Timeline</a></li><li><a href="/wiki">Wiki</a></li><li class="last"><a href="/search">Search</a></li>
    </ul>
  </div>
          <div id="main">
      <div id="ctxtnav" class="nav">
        <h2>Context Navigation</h2>
        <ul>
          <li class="first"><span>&larr; <a class="prev" href="/ticket/22994" title="Ticket #22994">Previous Ticket</a></span></li><li class="last"><span><a class="next" href="/ticket/22996" title="Ticket #22996">Next Ticket</a> &rarr;</span></li>
        </ul>
        <hr />
      </div>
    <div id="content" class="ticket">
        <div id="ticket" class="trac-content ">
  <div class="date">
    <p>Opened <a class="timeline" href="/timeline?from=2014-07-10T11%3A11%3A38-05%3A00&amp;precision=second" title="See timeline at 07/10/14 11:11:38">20 months ago</a></p>
    <p>Last modified <a class="timeline" href="/timeline?from=2015-09-04T11%3A48%3A03-05%3A00&amp;precision=second" title="See timeline at 09/04/15 11:48:03">6 months ago</a></p>
  </div>
  <h2>
    <a href="/ticket/22995" class="trac-id">#22995</a>
    <span class="trac-status">
      <a href="/query?status=new">new</a>
    </span>
    <span class="trac-type">
      <a href="/query?status=!closed&amp;type=Cleanup%2Foptimization">Cleanup/optimization</a>
    </span>
  </h2>
  <h1 id="trac-ticket-title" class="searchable">
    <span class="summary">Deprecate auto_now and auto_now_add and document alternatives</span>
  </h1>
  <table class="properties">
    <tr>
      <th id="h_reporter">Reported by:</th>
      <td headers="h_reporter" class="searchable"><a href="/query?status=!closed&amp;reporter=jezdez">jezdez</a></td>
      <th id="h_owner">Owned by:</th>
      <td headers="h_owner"><a href="/query?status=!closed&amp;owner=nobody">nobody</a></td>
    </tr>
    <tr>
        <th id="h_component">
          Component:
        </th>
        <td headers="h_component">
              <a href="/query?status=!closed&amp;component=Database+layer+(models%2C+ORM)">Database layer (models, ORM)</a>
        </td>
        <th id="h_version">
          Version:
        </th>
        <td headers="h_version">
              <a href="/query?status=!closed&amp;version=master">master</a>
        </td>
    </tr><tr>
        <th id="h_severity">
          Severity:
        </th>
        <td headers="h_severity">
              <a href="/query?status=!closed&amp;severity=Normal">Normal</a>
        </td>
        <th id="h_keywords" class="missing">
          Keywords:
        </th>
        <td headers="h_keywords" class="searchable">
        </td>
    </tr><tr>
        <th id="h_cc">
          Cc:
        </th>
        <td headers="h_cc" class="searchable">
              cmawebsite@…
        </td>
        <th id="h_stage">
          Triage Stage:
        </th>
        <td headers="h_stage">
              <a href="/query?status=!closed&amp;stage=Someday%2FMaybe">Someday/Maybe</a>
        </td>
    </tr><tr>
        <th id="h_has_patch">
          Has patch:
        </th>
        <td headers="h_has_patch">
              <a href="/query?status=!closed&amp;has_patch=0">no</a>
        </td>
        <th id="h_needs_docs">
          Needs documentation:
        </th>
        <td headers="h_needs_docs">
              <a href="/query?status=!closed&amp;needs_docs=0">no</a>
        </td>
    </tr><tr>
        <th id="h_needs_tests">
          Needs tests:
        </th>
        <td headers="h_needs_tests">
              <a href="/query?status=!closed&amp;needs_tests=0">no</a>
        </td>
        <th id="h_needs_better_patch">
          Patch needs improvement:
        </th>
        <td headers="h_needs_better_patch">
              <a href="/query?status=!closed&amp;needs_better_patch=0">no</a>
        </td>
    </tr><tr>
        <th id="h_easy">
          Easy pickings:
        </th>
        <td headers="h_easy">
              <a href="/query?status=!closed&amp;easy=0">no</a>
        </td>
        <th id="h_ui_ux">
          UI/UX:
        </th>
        <td headers="h_ui_ux">
              <a href="/query?status=!closed&amp;ui_ux=0">no</a>
        </td>
    </tr>
  </table>
  <div class="description">
    <h3 id="comment:description">
      Description
      <a href="/ticket/22995?action=diff&amp;version=1" class="lastmod trac-diff" title="2014-07-10 16:12:00.735422+00:00">
        (last modified by jezdez)
      </a>
    </h3>
    <div class="searchable">
      <p>
We've previously documented some side issues of the two options (e.g. <a class="closed ticket" href="/ticket/6434" title="auto_now and auto_now_add documentation (closed: fixed)">#6434</a>) but need to better clarify the downsides of those magic parameters. The ability to override the <tt>save</tt> method as well as the <tt>default</tt> parameter has long made this implicit feature capable of being replaced.<br />
</p>
<p>
This would probably also be a way to not let users fall in the trap as documented in <a class="closed ticket" href="/ticket/16745" title="Bug: Different times on fields with auto_now and auto_now_add (closed: wontfix)">#16745</a> and <a class="closed ticket" href="/ticket/22571" title="Cleanup/optimization: Document implications of using auto_now_add=True and get_or_create (closed: fixed)">#22571</a>.<br />
</p>
<p>
In a previous *old* discussion there were multiple core developers in favor of the deprecation: <a class="ext-link" href="https://groups.google.com/forum/#!topic/django-developers/TNYxwiXLTlI"><span class="icon">​</span>https://groups.google.com/forum/#!topic/django-developers/TNYxwiXLTlI</a><br />
</p>

    </div>
  </div>
</div>
          

        <div>
          <div style="position: relative">
            <form id="prefs" method="get" action="/prefs" style="position: absolute; right: 0">
              <div id="trac-comments-order">
                <input type="radio" id="trac-comments-oldest" name="trac-comments-order" value="oldest" checked="checked" />
                <label for="trac-comments-oldest">Oldest first</label>
                <input type="radio" id="trac-comments-newest" name="trac-comments-order" value="newest" />
                <label for="trac-comments-newest">Newest first</label>
                <span id="trac-threaded-toggle" style="display: none">
                  <input type="radio" id="trac-comments-threaded" name="trac-comments-order" value="threaded" />
                  <label for="trac-comments-threaded">Threaded</label>
                </span>
              </div>
              <div>
                <input id="trac-comments-only-toggle" type="checkbox" />
                <label for="trac-comments-only-toggle">Comments only</label>
              </div>
            </form>
          </div>
          <h3 class="foldable">Change History <span class="trac-count">(15)</span></h3>
          <div id="changelog">
              <div class="change" id="trac-change-1-1405008720735422">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:1" class="cnum">
    <a href="#comment:1">comment:1</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T11%3A12%3A00-05%3A00&amp;precision=second" title="See timeline at 07/10/14 11:12:00">20 months ago</a> by jezdez
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-description">
      <strong class="trac-field-description">Description</strong>
        modified (<a href="/ticket/22995?action=diff&amp;version=1">diff</a>)
    </li>
  </ul>

              </div>
              <div class="change" id="trac-change-2-1405011187672772">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:2" class="cnum">
    <a href="#comment:2">comment:2</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T11%3A53%3A07-05%3A00&amp;precision=second" title="See timeline at 07/10/14 11:53:07">20 months ago</a> by aaugustin
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
AFAIK most core devs still agree that they should be removed. But it was never a priority because we simply avoid them in our projets ;-)<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-3-1405023460775964">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:3" class="cnum">
    <a href="#comment:3">comment:3</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T15%3A17%3A40-05%3A00&amp;precision=second" title="See timeline at 07/10/14 15:17:40">20 months ago</a> by kmtracey
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I'm not really enthused about removing them, I agree with what Russell said here: <a href="https://code.djangoproject.com/ticket/12785#comment:1">https://code.djangoproject.com/ticket/12785#comment:1</a><br />
</p>
<p>
In my experience they are (still) very commonly used. That original pre-1.0 discussion brings up that having to manually override save for every model where you have an auto-something field is going to be a pain in the neck, there was agreement on that, no specific alternative proposal got implemented and I don't see one here so we'd deprecate these w/ no replacement? That seems rude.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-4-1405026457812413">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:4" class="cnum">
    <a href="#comment:4">comment:4</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T16%3A07%3A37-05%3A00&amp;precision=second" title="See timeline at 07/10/14 16:07:37">20 months ago</a> by aaugustin
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I've seen several people go through the pain of replacing auto_now(_add) with the more explicit alternatives (default=timezone.now / override save()) after hitting bugs in production.<br />
</p>
<p>
In fact, they weren't really bugs, but cases where the actual and documented behaviour diverged from what the developer expected — which has always been the rationale for removing them.<br />
</p>
<p>
I would be fine with deprecating them (i.e. raise a DeprecationWarning) but never actually remove them (i.e. we wouldn't advance the deprecation at each release like we usually do). That would discourage their use without giving the finger to people who find them good enough.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-5-1405027162805007">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:5" class="cnum">
    <a href="#comment:5">comment:5</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T16%3A19%3A22-05%3A00&amp;precision=second" title="See timeline at 07/10/14 16:19:22">20 months ago</a> by timo
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I put together a <a class="ext-link" href="https://github.com/django/django/pull/5233"><span class="icon">​</span>proof of concept</a> for removing usage of <tt>auto_add</tt> from the admin. I agree removing them would be disruptive. We have done a similar thing to what Aymeric suggested (deprecating, but not removing) with <a class="ext-link" href="https://docs.djangoproject.com/en/1.6/ref/models/instances/#the-permalink-decorator"><span class="icon">​</span>@permalink</a>.<br />
</p>

    </div>
  <div class="trac-lastedit ">
    Last edited <a class="timeline" href="/timeline?from=2015-09-04T11%3A48%3A03-05%3A00&amp;precision=second" title="See timeline at 09/04/15 11:48:03">6 months ago</a>
        by timgraham
      (<a href="/ticket/22995?cversion=0&amp;cnum_hist=5#comment:5">previous</a>)
      (<a href="/ticket/22995?action=comment-diff&amp;cnum=5&amp;version=1">diff</a>)
  </div>

              </div>
              <div class="change" id="trac-change-6-1405037795351803">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:6" class="cnum">
    <a href="#comment:6">comment:6</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T19%3A16%3A35-05%3A00&amp;precision=second" title="See timeline at 07/10/14 19:16:35">20 months ago</a> by kmtracey
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Doesn't the POC replace an auto_now flag w/ a save override that is implementing auto_add_now? Which possibly does not matter since admin log entries are generally not editable...?<br />
</p>
<p>
What are the unexpected behaviors that can be fixed by replacing with default/override save()? Or is it just more clear what the behavior will be?<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-7-1405038762269660">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:7" class="cnum">
    <a href="#comment:7">comment:7</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T19%3A32%3A42-05%3A00&amp;precision=second" title="See timeline at 07/10/14 19:32:42">20 months ago</a> by timo
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Yes, I'd consider the fact that it currently uses <tt>auto_now</tt> and not <tt>auto_add_now</tt> to be a bug. It probably doesn't matter as you said, but if for some reason admin log entries are edited in a shell or whatever, I wouldn't expect the <tt>action_time</tt> to be updated.<br />
</p>
<p>
The tickets linked in the description show some "gotchas" when these flags, you can also google "django auto_now evil" to find complaints. <a class="closed ticket" href="/ticket/22981" title="Bug: Fields with auto_now=True are not updated if the field name is not ... (closed: wontfix)">#22981</a> is also a related issue which stems from the fact that the expected behavior is not clearly  defined (or at least it's poorly documented).<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-8-1405039400907854">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:8" class="cnum">
    <a href="#comment:8">comment:8</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T19%3A43%3A20-05%3A00&amp;precision=second" title="See timeline at 07/10/14 19:43:20">20 months ago</a> by kmtracey
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Right, I do understand some of the gothcas, what I'm missing is if/how they are alleviated by users implementing their own? All of them I have seen it seems are still going to be a problem with self-implementation...? Hence my question on how this improves things, is is just (hopefully) clearer to the person doing it what the side-effects will be vs. a magical flag that does less than they think it will?<br />
</p>

    </div>
  <div class="trac-lastedit ">
    Last edited <a class="timeline" href="/timeline?from=2014-07-10T19%3A46%3A06-05%3A00&amp;precision=second" title="See timeline at 07/10/14 19:46:06">20 months ago</a>
        by kmtracey
      (<a href="/ticket/22995?cversion=0&amp;cnum_hist=8#comment:8">previous</a>)
      (<a href="/ticket/22995?action=comment-diff&amp;cnum=8&amp;version=1">diff</a>)
  </div>

              </div>
              <div class="change" id="trac-change-9-1405041035120359">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:9" class="cnum">
    <a href="#comment:9">comment:9</a>
  </span>
          <span>follow-ups:</span>
    <a href="#comment:10" class="follow-up">↓ 10</a>
    <a href="#comment:11" class="follow-up">↓ 11</a>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-10T20%3A10%3A35-05%3A00&amp;precision=second" title="See timeline at 07/10/14 20:10:35">20 months ago</a> by russellm
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
If <tt>auto_now</tt> and <tt>auto_now_add</tt> have bugs, then we should address them; if there is potential for confusion around when they will (or won't) apply changes, we should document that too - just as we do when we note that <tt>update</tt> doesn't trigger pre/post save signals.<br />
</p>
<p>
I simply don't understand the motivation of removing features that implement an obvious and well defined use case - creation timestamp and modification timestamp - without providing an equally functional alternative. In order to use default= as a replacement for auto_now_add, you need to: <br />
</p>
<ul><li>Remember to use <tt>timezone.now</tt>, not <tt>datetime.now</tt>
</li><li>Remember to use <tt>timezone.now</tt>, not <tt>timezone.now()</tt>
</li><li>Remember to <tt>include django.utils import timezone</tt>
</li></ul><p>
That's three easily avoidable opportunities for someone to mess up the simple use case of "creation timestamp". And it gets worse if you want auto_now, because you have to write and test a bunch of boilerplate code at the model level.<br />
</p>
<p>
If there really is a visceral hatred of <tt>auto_now</tt> and <tt>auto_now_add</tt> as names, then at the very least we need to introduce a <tt>CreationDateTimeField</tt>, <tt>ModificationDateTimeField</tt>, <tt>CreationDateField</tt>, and <tt>ModificationDateField</tt>... but are those *really* that much better names than <tt>auto_now</tt> and <tt>auto_now_add</tt>?<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-10-1405060730334750">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:10" class="cnum">
    <a href="#comment:10">comment:10</a>
  </span>
        in reply to:
    <a href="#comment:9">↑ 9</a>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-11T01%3A38%3A50-05%3A00&amp;precision=second" title="See timeline at 07/11/14 01:38:50">20 months ago</a> by jezdez
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
+1 on marking it with DeprecationWarning but letting it sit there to ease the upgrading pain.<br />
</p>
<p>
Replying to <a class="ticket" href="/ticket/22995#comment:9" title="Comment 9">russellm</a>:<br />
</p>
<blockquote class="citation">
<p>
If <tt>auto_now</tt> and <tt>auto_now_add</tt> have bugs, then we should address them; if there is potential for confusion around when they will (or won't) apply changes, we should document that too - just as we do when we note that <tt>update</tt> doesn't trigger pre/post save signals.<br />
</p>
<p>
I simply don't understand the motivation of removing features that implement an obvious and well defined use case - creation timestamp and modification timestamp - without providing an equally functional alternative. In order to use default= as a replacement for auto_now_add, you need to: <br />
</p>
<ul><li>Remember to use <tt>timezone.now</tt>, not <tt>datetime.now</tt>
</li><li>Remember to use <tt>timezone.now</tt>, not <tt>timezone.now()</tt>
</li><li>Remember to <tt>include django.utils import timezone</tt>
</li></ul><p>
That's three easily avoidable opportunities for someone to mess up the simple use case of "creation timestamp". And it gets worse if you want auto_now, because you have to write and test a bunch of boilerplate code at the model level.<br />
</p>
</blockquote>
<p>
And yet, I believe knowing those steps are essential for any non-trivial Django project. Anecdotally I've often at some point converted the auto_now to a default call as soon as a model got a little more complex to use a consistent API for default values. I also consider overriding save methods not boilerplate but a core API of model classes -- again an often used one.<br />
</p>
<p>
In that sense I believe the auto_now and auto_now_add parameters has not only actual technical issues, but also prevents our users to learn important APIs.<br />
</p>
<blockquote class="citation">
<p>
If there really is a visceral hatred of <tt>auto_now</tt> and <tt>auto_now_add</tt> as names, then at the very least we need to introduce a <tt>CreationDateTimeField</tt>, <tt>ModificationDateTimeField</tt>, <tt>CreationDateField</tt>, and <tt>ModificationDateField</tt>... but are those *really* that much better names than <tt>auto_now</tt> and <tt>auto_now_add</tt>?<br />
</p>
</blockquote>
<p>
Agreed, I think that would be a good compromise for users that don't want to manually handle auto_now and auto_now_add via default/save. There are CreationDateTimeField and ModificationDateTimeField fields in django-extensions in case we want to rely on a solution that's been in wide use for years.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-11-1405074283477734">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:11" class="cnum">
    <a href="#comment:11">comment:11</a>
  </span>
        in reply to:
    <a href="#comment:9">↑ 9</a>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-11T05%3A24%3A43-05%3A00&amp;precision=second" title="See timeline at 07/11/14 05:24:43">20 months ago</a> by aaugustin
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
Replying to <a class="ticket" href="/ticket/22995#comment:9" title="Comment 9">russellm</a>:<br />
</p>
<blockquote class="citation">
<p>
I simply don't understand the motivation of removing features that implement an obvious and well defined use case - creation timestamp and modification timestamp - without providing an equally functional alternative.<br />
</p>
</blockquote>
<p>
 <br />
</p>
<p>
Precisely, I think we should at least deprecate them because the use case is very obvious but auto_now(_add) don't implement it — and maybe can't!<br />
</p>
<p>
Creation and modification timestamps are expected to be set automatically, regardless of how you access the row. Rails does this well at the database level.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-12-1405087147041599">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:12" class="cnum">
    <a href="#comment:12">comment:12</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-11T08%3A59%3A07-05%3A00&amp;precision=second" title="See timeline at 07/11/14 08:59:07">20 months ago</a> by kmtracey
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
I'm not much of a fan of deprecating without removing either as I'm not a big fan of nanny warnings. If I know what I'm doing, have read the doc and understand the limitations of what I'm using, I don't really want the code nagging me that what I'm doing is "unclean". Bleh. Near as I can tell the straightforward do-it-yourself implementations are going to be equally vulnerable to gotchas...how is forcing people to try doing it themselves any better?<br />
</p>
<p>
For the alternatives proposed: are they going to be immune from the gotcahs of the existing implementation? If not then why bother? <br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-13-1406069426661576">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:13" class="cnum">
    <a href="#comment:13">comment:13</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-07-22T17%3A50%3A26-05%3A00&amp;precision=second" title="See timeline at 07/22/14 17:50:26">20 months ago</a> by timo
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-stage">
      <strong class="trac-field-stage">Triage Stage</strong>
        changed from <em>Unreviewed</em> to <em>Someday/Maybe</em>
    </li><li class="trac-field-version">
      <strong class="trac-field-version">Version</strong>
        changed from <em>1.6</em> to <em>master</em>
    </li>
  </ul>
    <div class="comment searchable">
      <p>
Moving to someday/maybe as this needs more investigation to answer the above questions before being accepted or rejected.<br />
</p>

    </div>

              </div>
              <div class="change" id="trac-change-14-1407271573737557">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:14" class="cnum">
    <a href="#comment:14">comment:14</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-08-05T15%3A46%3A13-05%3A00&amp;precision=second" title="See timeline at 08/05/14 15:46:13">20 months ago</a> by CollinAnderson
  </h3>
  <div class="trac-ticket-buttons">
  </div>
    <div class="comment searchable">
      <p>
We wouldn't ever consider adding a <tt>models.now()</tt> shortcut, would we? It's a little magical, but a very common use case. The import is what bugs me the most. You need to import something from "utils" in many of your models files. It seems similar to <tt>models.SET_NULL</tt>.<br />
</p>
<p>
Or, have a magical <tt>models.DateField(default='now')</tt> (solves the <tt>now</tt> vs <tt>now()</tt>) or the longer: <tt>models.DateField(default=models.DateField.now)</tt><br />
</p>

    </div>
  <div class="trac-lastedit ">
    Last edited <a class="timeline" href="/timeline?from=2014-08-06T07%3A44%3A15-05%3A00&amp;precision=second" title="See timeline at 08/06/14 07:44:15">20 months ago</a>
        by CollinAnderson
      (<a href="/ticket/22995?cversion=2&amp;cnum_hist=14#comment:14">previous</a>)
      (<a href="/ticket/22995?action=comment-diff&amp;cnum=14&amp;version=3">diff</a>)
  </div>

              </div>
              <div class="change" id="trac-change-15-1407329070373651">
                
  <h3 class="change">
    <span class="threading">
      <span id="comment:15" class="cnum">
    <a href="#comment:15">comment:15</a>
  </span>
    </span>
        Changed <a class="timeline" href="/timeline?from=2014-08-06T07%3A44%3A30-05%3A00&amp;precision=second" title="See timeline at 08/06/14 07:44:30">20 months ago</a> by CollinAnderson
  </h3>
  <div class="trac-ticket-buttons">
  </div>
  <ul class="changes">
    <li class="trac-field-cc">
      <strong class="trac-field-cc">Cc</strong>
        <em>cmawebsite@…</em> added
    </li>
  </ul>

              </div>
          </div>
        </div>
      <div id="help"><strong>Note:</strong> See
        <a href="/wiki/TracTickets">TracTickets</a> for help on using
        tickets.</div>
    </div>
    <div id="altlinks">
      <h3>Download in other formats:</h3>
      <ul>
        <li class="first">
          <a rel="nofollow" href="/ticket/22995?format=csv" class="csv">Comma-delimited Text</a>
        </li><li>
          <a rel="nofollow" href="/ticket/22995?format=tab" class="tab">Tab-delimited Text</a>
        </li><li class="last">
          <a rel="nofollow" href="/ticket/22995?format=rss" class="rss">RSS Feed</a>
        </li>
      </ul>
    </div>
    </div>
          <a href="#top" class="backtotop"><i class="icon icon-chevron-up"></i> Back to Top</a>
        </div>
      </div>
    <div role="contentinfo">
      <div class="subfooter">
        <div class="container">
          <h1 class="visuallyhidden">Django Links</h1>
          <div class="col learn">
            <h2>Learn More</h2>
            <ul>
              <li><a href="https://www.djangoproject.com/overview/">About Django</a></li>
              <li><a href="https://www.djangoproject.com/start/">Getting Started with Django</a></li>
              <li><a href="https://www.djangoproject.com/foundation/">Django Software Foundation</a></li>
              <li><a href="https://www.djangoproject.com/conduct/">Code of Conduct</a></li>
            </ul>
          </div>
          <div class="col involved">
            <h2>Get Involved</h2>
            <ul>
              <li><a href="https://www.djangoproject.com/community/">Join a Group</a></li>
              <li><a href="https://docs.djangoproject.com/en/dev/internals/contributing/">Contribute to Django</a></li>
              <li><a href="https://docs.djangoproject.com/en/dev/internals/contributing/bugs-and-features/#reporting-security-issues">Submit a Bug</a></li>
              <li><a href="https://docs.djangoproject.com/en/dev/internals/security/">Report a Security Issue</a></li>
            </ul>
          </div>
          <div class="col follow">
            <h2>Follow Us</h2>
            <ul>
              <li><a href="http://github.com/django">GitHub</a></li>
              <li><a href="https://twitter.com/djangoproject">Twitter</a></li>
              <li><a href="https://www.djangoproject.com/rss/weblog/">News RSS</a></li>
              <li><a href="https://groups.google.com/forum/#!forum/django-users">Django Users Mailing List</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="footer">
        <div class="container">
          <div class="footer-logo">
            <a class="logo" href="https://djangoproject.com/">Django</a>
          </div>
          <ul class="thanks">
            <li><span>Hosting by</span> <a class="rackspace" href="http://rackspace.com">Rackspace</a></li>
            <li class="design"><span>Design by</span> <a class="threespot" href="http://www.threespot.com">Threespot</a> <span class="ampersand">&amp;</span> <a class="andrevv" href="http://andrevv.com/"></a></li>
          </ul>
          <p class="copyright">© 2005-2016
              <a href="https://djangoproject.com/foundation/"> Django Software
              Foundation</a> unless otherwise noted. Django is a
              <a href="https://djangoproject.com/trademarks/">registered
              trademark</a> of the Django Software Foundation.
          </p>
        </div>
      </div>
    </div>
  <script data-main="/chrome/site/js/main.js" src="/chrome/site/js/lib/require.js"></script>
  </body>
</html>